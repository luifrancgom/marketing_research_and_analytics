---
title: "Identifying Drivers of Outcomes"
author: 
  - Nohra Jones
  - Bill Gates
  - Luis Francisco Gomez
date: 2025-11-12 
format: 
  html:
    toc: true
    number-sections: true
    embed-resources: true
    code-fold: true  
---

```{r}
#| label: libraries
#| message: false

library(tidyverse)
library(skimr)
library(corrr)
library(tidymodels)
library(performance)
```

# Introduction

Pending

# Import

Pending

```{r}
#| label: import
#| message: false

amusement_park <- read_csv(file = "../000_data/007_chapter_7.csv")
```

# Transform

```{r}
amusement_park <- amusement_park |> 
  mutate(
    weekend = factor(x = weekend,
                     ordered = FALSE),
    num.child = as.integer(x = num.child),
    logdist = log(x = distance, base = exp(1))
  )
```

# Summarize

```{r}
amusement_park |> 
  skim()
```

# Correlation matrix

```{r}
#| label: correlation-matrix
#| message: false
#| warning: false

correlation_matrix <- amusement_park |> 
  select(where(is.numeric)) |> 
  correlate(
    method = "pearson", 
    use = "pairwise.complete.obs" 
  )

correlation_matrix |> 
  autoplot(triangular = "lower")
```

# Modeling

## Model 1

```{r}
model_1 <- lm(
  formula = overall ~ rides,
  data = amusement_park
)

model_1_tidy <- model_1 |> 
  tidy()

model_1_tidy
```

### Checking assumptions: model 1

```{r}
#| fig-height: 9
#| fig-width: 8
check_model(x = model_1)
```

## Model 2

```{r}
model_2 <- lm(
  formula = overall ~ rides + games + wait + clean,
  data = amusement_park
)

model_2_tidy <- model_2 |> 
  tidy()

model_2_tidy
```

### Checking assumptions: model 2

```{r}
#| fig-height: 9
#| fig-width: 8

check_model(x = model_2)
```

