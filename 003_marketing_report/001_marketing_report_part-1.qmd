---
title: "Marketing report part 1"
date: 2025-10-18
author: 
  - Norah Jones   
  - Bill Gates
  - Luis Francisco GÃ³mez
format: 
  html:
    toc: true
    code-fold: true
    number-sections: true
    embed-resources: true
editor: source
---

```{r }
#| label: libraries
#| message: false

library(tidyverse)
library(sweep)
library(skimr)
library(DT)
```

# Describing data

## Introduction

Pending

## Import data

Pending

```{r}
# Import the data from the sweep package
bike_sales <- bike_sales |> 
  mutate(order.id = factor(x = order.id, 
                           ordered = TRUE),
         order.line = factor(x = order.line,
                             ordered = TRUE),
         customer.id = factor(x = customer.id,
                              ordered = FALSE),
         bikeshop.name = factor(x = bikeshop.name,
                                ordered = FALSE),
         bikeshop.city = factor(x = bikeshop.city,
                                ordered = FALSE),
         bikeshop.state = factor(x = bikeshop.name,
                                 ordered = FALSE),
         product.id = factor(x = product.id,
                             ordered = FALSE),
         model = factor(x = model,
                        ordered = FALSE),
         category.primary = factor(category.primary,
                                   ordered = FALSE),
         category.secondary = factor(x = category.secondary,
                                     ordered = FALSE),
         frame = factor(x = frame,
                        ordered = FALSE))
```

## Inspect data

Pending

```{r}
bike_sales |> 
  glimpse()
```

## Summarize data

Pending

### Summary statistics

Pending

```{r}
bike_sales |> 
  skim()
```

### Counting

Pending

```{r}
category_secondary <- bike_sales |> 
  count(category.secondary) |> 
  select(category.secondary)

category_secondary |> 
  datatable(
    colnames = c("Category secondary" = "category.secondary") 
      )
```

```{r}
frame <- bike_sales |> 
  count(frame) |> 
  select(frame)

frame |> 
  datatable(
    colnames = c("Frame" = "frame") 
      )
```

```{r}
category_secondary_frame <- bike_sales |> 
  count(category.secondary,
        frame) |> 
  select(category.secondary, frame)

category_secondary_frame |> 
  datatable(
    colnames = c("Category secondary" = "category.secondary",
      "Frame" = "frame") 
  )
```

Pending

```{r}
bike_shops <- bike_sales |> 
  count(bikeshop.name, 
        sort = TRUE)

bike_shops |> 
  datatable(
    colnames = c("Bike shop" = "bikeshop.name",
      "Transactions" = "n")
  )
```

## Data visualization

Pending

### Histograms

Pending

#### Quantity behavior

Pending

```{r}
bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = quantity),
                 color = "black",
                 fill = "steelblue",
                 bins = 30) +
  labs(x = "Units sold",
       y = "Frequency",
       subtitle = "Distribution of units sold")
```

#### Price behavior

Pending

```{r}
bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = price),
                 color = "black",
                 fill = "steelblue",
                 bins = 30) +
  labs(x = "Price (US Dollars)",
       y = "Frequency",
       subtitle = "Distribution of frame prices")
```

### Boxplots

In this section generate 2 boxplots to explore the following items and point out the main finding in relation to these visualizations:

-   Examine the revenue generated by the corporation, `price.ext`, according to the specific bicycle categories, `category.secondary`

-   Examine the revenue generated by the corporation, `price.ext`, according to the bicycle frame material, `frame`

```{r}
# You can use the function boxplot, ?boxplot,from base R
# or the function geom_boxplot, ?geom_boxplot,from the 
# tidyverse
## If you use the tidyverse check out the 
## online documentation in
### https://ggplot2.tidyverse.org/reference/geom_boxplot.html
```

## Questions answered with data

This is a miscellaneous section where the idea is to answer questions using the `bike_sales` data set. Answer the following questions using the `tidyverse` and the functions `group_by`, `summarise`, `mutate`, `fct_reorder`, `ggplot` and `geom_col`:

-   What are the bike shops, `bikeshop.name`, that generate more revenue, `price.ext`, to the corporation?

-   What are the specific bicycle categories, `category.secondary`, that generate more revenue, `price.ext`, to the corporation?

To answer the above questions divide the process in 2 states:

-   First, prepare the data
-   Second, visualize the data

You can use the following example as a guidance where the variable `bikeshop.city` is used to answer what cities generate more revenue, `price.ext`:

```{r}
#| code-fold: show
#| eval: false

# Prepare data
bike_sales_total_revenue_by_city <- bike_sales |> 
  group_by(bikeshop.city) |> 
  summarise(total_revenue = sum(price.ext)) |> 
  mutate(bikeshop.city = fct_reorder(.f = bikeshop.city,
                                     .x = total_revenue)) 

# Visualize data
bike_sales_total_revenue_by_city |> 
  ggplot(aes(x = total_revenue, y = bikeshop.city)) + 
  geom_col()
```
