---
title: "Marketing report part 1"
date: 2024-04-20
author: 
  - Luis Francisco Gomez Lopez   
  - Participante 2
  - Participante 3
  - Participante 4
  - Participante 5
format: 
  html:
    toc: true
    toc-depth: 2
    code-fold: true
    number-sections: true
    embed-resources: true
editor: visual
---

```{r }
#| label: libraries
#| echo: false
#| message: false
library(sweep)
library(tidyverse)
library(skimr)
```

# Describing data

## Introduction

Once your group has finish filling all the sections, add some text here describing the principal findings. Be straightforward and concise taking into account that it is a executive report.

## Import data

Add some text if your group consider to be necessary.

```{r}
# Import the data from the sweep package
bike_sales <- bike_sales
bike_sales |> head()
```

## Inspect data

Use the available functions from base R or the `tidyverse` to inspect the data

```{r}
bike_sales |> glimpse()
```

## Summarize data

Add some text pointing out the principal findings as a result of calculating some summary statistics and counting different combination of categories

### Summary statistics

In this section calculate some summary statistics using base R or the `skimr` package

```{r}
bike_sales |> skim()
```

### Counting

Checking `category.secondary`

```{r}
bike_sales |> count(category.secondary)
```

Checking `frame`

```{r}
bike_sales |> count(frame)
```

Checking the available products

```{r}
bike_sales |> 
  count(category.secondary, frame)
```

#### Product gap

There is a product gap because the availabel products are 13 and we possible products can be 18, so there is a product gap of 5 potential model:

-   Cyclocross Aluminium
-   Fat Bike Carbon
-   Over Mountain Aluminium
-   Sport Carbon
-   Triathalon Aluminium

#### Actual customers

Knowing our clients by the volume of products they demand

-   Customers we want to retain

```{r}
bike_sales |> 
  count(bikeshop.name, sort = TRUE) |> 
  head()
```

-   Customers that have potential

```{r}
bike_sales |> 
  count(bikeshop.name, sort = TRUE) |> 
  tail()
```

## Data visualization

Add some text pointing out the principal findings as a result of visualizing the suggested variables.

### Histograms

Check the distribution of the variables `quantity` and `price` to understand its behavior using the function `hist` from base R or the `tidyverse` through the package `ggplot2`

#### Quantity behavior

```{r}
#| message: false
bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = quantity),
                 color = "black") +
  labs(x = "Quantity of bikes (units)",
       y = "Count",
       title = "Distribution of bike sold for all bike shops")
```

#### Price behavior

```{r}
#| message: false
bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = price),
                 color = "black") +
  labs(x = "Unitary price of bikes (dollars)",
       y = "Count",
       title = "Distribution of bike prices for all bike shops")
```

### Boxplots

In this section generate 2 boxplots to explore the following items and point out the main finding in relation to these visualizations:

-   Examine the revenue generated by the corporation, `price.ext`, according to the specific bicycle categories, `category.secondary`

```{r}
bike_sales |> 
  ggplot() +
  geom_boxplot(aes(x = price.ext, 
                   y = category.secondary)) +
  scale_x_continuous(labels = scales::label_dollar()) +
  labs(x = "Revenue by transaction (Dollars)",
       y = "Bike models by second category",
       title = "Distribution of revenue by second category")
```


-   Examine the revenue generated by the corporation, `price.ext`, according to the bicycle frame material, `frame`

```{r}
bike_sales |> 
  ggplot() +
  geom_boxplot(aes(x = price.ext, 
                   y = frame)) +
  scale_x_continuous(labels = scales::label_dollar()) +
  labs(x = "Revenue by transaction (Dollars)",
       y = "Bike models by frame",
       title = "Distribution of revenue by frame") 
```

## Questions answered with data

This is a miscellaneous section where the idea is to answer questions using the `bike_sales` data set. Answer the following questions using the `tidyverse` and the functions `group_by`, `summarise`, `mutate`, `fct_reorder`, `ggplot` and `geom_col`:

-   What are the bike shops, `bikeshop.name`, that generate more revenue, `price.ext`, to the corporation?

```{r}
# Checking revenue by customer
bike_sales_by_bikeshop_revenue <- bike_sales |> 
  select(bikeshop.name, price.ext) |> 
  group_by(bikeshop.name) |> 
  summarise(total_revenue = sum(price.ext)) |> 
  arrange(desc(total_revenue))

bike_sales_by_bikeshop_revenue |> 
  mutate(bikeshop.name = fct_reorder(bikeshop.name, 
                                     total_revenue)) |> 
  ggplot() +
  geom_col(aes(x = total_revenue, 
               y = bikeshop.name)) +
  scale_x_continuous(labels = scales::label_dollar()) +
  labs(x = "Revenue (Dollars)",
       y = "Bike shops",
       title = "Revenue by bike shops")
```

-   What are the specific bicycle categories, `category.secondary`, that generate more revenue, `price.ext`, to the corporation?

```{r}
# Checking revenue by second category
bike_sales_by_bikeshop_second_category <- bike_sales |> 
  select(category.secondary, price.ext) |> 
  group_by(category.secondary) |> 
  summarise(total_revenue = sum(price.ext)) |> 
  arrange(desc(total_revenue))

bike_sales_by_bikeshop_second_category |> 
  mutate(category.secondary = fct_reorder(category.secondary, 
                                     total_revenue)) |> 
  ggplot() +
  geom_col(aes(x = total_revenue, 
               y = category.secondary)) +
  scale_x_continuous(labels = scales::label_dollar()) +
  labs(x = "Revenue (Dollars)",
       y = "Second Category",
       title = "Revenue by second category")
```
