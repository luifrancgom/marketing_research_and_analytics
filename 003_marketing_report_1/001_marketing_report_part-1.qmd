---
title: "Marketing report part 1"
date: 2025-04-12
author: 
  - Norah Jones   
  - Bill Gates
  - Francisco Gomez
format: 
  html:
    toc: true
    code-fold: true
    number-sections: true
    embed-resources: true
editor: visual
---

```{r }
#| label: libraries
#| echo: false
#| message: false

library(sweep)
library(tidyverse)
library(skimr)
library(DT)
```

# Describing data

## Introduction

Once your group has finish filling all the sections, add some text here describing the principal findings. Be straightforward and concise taking into account that it is a executive report.

## Import data

Add some text if your group consider to be necessary.

```{r}
# Import data ----
bike_sales <- bike_sales
```

## Inspect data

Use the available functions from base R or the `tidyverse` to inspect the data

```{r}
bike_sales |> 
  glimpse()
```

## Summarize data

Add some text pointing out the principal findings as a result of calculating some summary statistics and counting different combination of categories

### Summary statistics

In this section calculate some summary statistics using base R or the `skimr` package

```{r}
bike_sales |> 
  skim()
```

### Counting

Remember that you want to support the Research and Development (R & D) division in identifying potential new products

You can use the `count` function from the `tidyverse` and the variables `category.secondary` and `frame` to identify [product gaps](https://en.wikipedia.org/wiki/Gap_analysis). In that way you can identify possible new models that are not yet offered by the corporation but that can potentially generate an important revenue:

-   First, check the specific bicycle categories: `bike_sales |> count(category.secondary)`

-   Second, check the bicycle frame materials: `bike_sales |> count(frame)`

-   Third, you can calculate the possible combinations (Hint: There are $9 \times 2 = 18$ possible combinations)

Applying the above steps, you can proceed in the following way to identify [product gaps](https://en.wikipedia.org/wiki/Gap_analysis) (Hint: Only $13$ combinations are available which means that $18 - 13 = 5$ new models can be explored):

```{r}
bike_sales |> 
  count(category.secondary, sort = TRUE) |> 
  datatable()
```

```{r}
bike_sales |> 
  count(frame, sort = TRUE) |> 
  datatable()
```

```{r}
bike_sales |> 
  count(category.secondary,
        frame, sort = TRUE) |> 
  datatable()
```

Also remember that you want to support the marketing team in the creation of a marketing segmentation clustering model. Therefore the first step is to know the bicycle shops and the number of transactions. You can proceed in the following way as a first step:

```{r}
bike_sales |> 
  count(bikeshop.name, sort = TRUE) |> 
  datatable()
```

## Data visualization

Add some text pointing out the principal findings as a result of visualizing the suggested variables.

### Histograms

Check the distribution of the variables `quantity` and `price` to understand its behavior using the function `hist` from base R or the `tidyverse` through the package `ggplot2`

#### Quantity behavior

```{r}

bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = quantity),
                 # Number of bins in the histogram
                 bins = 30,
                 color = "black") +
  labs(x = "Quantity of units sold",
       y = "Frequency",
       title = "Distribution of quantity frames sold")
```

#### Price behavior

```{r}
bike_sales |> 
  ggplot() +
  geom_histogram(aes(x = price),
                 bins = 30,
                 color = "black") +
  labs(x = "Price (US Dollars)",
       y = "Frequency",
       title = "Distribution of prices")
```

### Boxplots

In this section generate 2 boxplots to explore the following items and point out the main finding in relation to these visualizations:

-   Examine the revenue generated by the corporation, `price.ext`, according to the specific bicycle categories, `category.secondary`

-   Examine the revenue generated by the corporation, `price.ext`, according to the bicycle frame material, `frame`

```{r}
bike_sales |> 
  ggplot() +
  geom_boxplot(aes(x = price.ext,
                   y = category.secondary)) +
  scale_x_continuous(labels = scales::label_currency()) +
  labs(x = "Revenue (US Dollars)",
       y = "Category secondary",
       title = "Distribution of revenue by category secondary")
```

```{r}
bike_sales |> 
  ggplot() + 
  geom_boxplot(aes(x = price.ext, 
                   y = frame)) +
  scale_x_continuous(labels = scales::label_currency()) +
  labs(x = "Revenue (US Dollars)",
       y = "Frame",
       title = "Distribution of revenue by frame")
```

## Questions answered with data

This is a miscellaneous section where the idea is to answer questions using the `bike_sales` data set. Answer the following questions using the `tidyverse` and the functions `group_by`, `summarise`, `mutate`, `fct_reorder`, `ggplot` and `geom_col`:

-   What are the bike shops, `bikeshop.name`, that generate more revenue, `price.ext`, to the corporation?

-   What are the specific bicycle categories, `category.secondary`, that generate more revenue, `price.ext`, to the corporation?

To answer the above questions divide the process in 2 states:

-   First, prepare the data
-   Second, visualize the data

You can use the following example as a guidance where the variable `bikeshop.city` is used to answer what cities generate more revenue, `price.ext`:

```{r}
## Prepare data ----
revenue_by_bikeshop <- bike_sales |> 
  group_by(bikeshop.name) |> 
  summarise(total_revenue = sum(price.ext)) |> 
  mutate(bikeshop.name = fct_reorder(.f = bikeshop.name, 
                                     .x = total_revenue))

## Visualization revenue by bike shop ----
revenue_by_bikeshop |> 
  ggplot() + 
  geom_col(aes(x = total_revenue,
               y = bikeshop.name)) +
  scale_x_continuous(labels = scales::label_currency()) +
  labs(x = "Total revenue (US Dollars)",
       y = "Bike shops",
       title = "Total revenue by bike shop")
```

```{r}
## Prepare data ----
revenue_by_category_secondary <- bike_sales |> 
  group_by(category.secondary) |> 
  summarise(total_revenue = sum(price.ext)) |> 
  mutate(category.secondary = fct_reorder(.f = category.secondary, 
                                          .x = total_revenue))

## Visualization total revenue by category secondary ----
revenue_by_category_secondary |> 
  ggplot() +
  geom_col(aes(x = total_revenue, 
               y = category.secondary)) +
  scale_x_continuous(labels = scales::label_currency()) +
  labs(x = "Revenue (US Dollars)",
       y = "Category secondary",
       title = "Total revenue by category secondary")
```
